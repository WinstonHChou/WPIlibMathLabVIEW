<HTML>
<HEAD>
<TITLE>Trajectory_Library.lvlib:DiffOdometry_Update.vi</TITLE>
<META NAME="Author" CONTENT="">
<META NAME="GENERATOR" CONTENT="G Development Environment">
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<A NAME="Trajectory_Library.lvlib:DiffOdometry_Update.vi"></A><H2>Trajectory_Library.lvlib:DiffOdometry_Update.vi</H2>
<P>SubVI for differential drive odometry. Odometry allows you to track the  robot's position on the field over the course of a match using readings from  2 encoders and a gyroscope.</P>
<P></P>
<P>Teams can use odometry during the autonomous period for complex tasks like path following. Furthermore, odometry can be used for latency compensation when using computer-vision systems.</P>
<P></P>
<P>Updates the robot position on the field using distance measurements from encoders. This method is more numerically accurate than using velocities to integrate the pose and is also advantageous for teams that are using lower CPR encoders.</P>
<P></P>
<P>This implementation slightly differs from the WPILIB C++/Java.  The constructor, Update and Reset functions are incorporated into this single routine.  There is no need to reset encoders or gyros.  This routine compensates by remembering the values at reset.  An optional &quot;Initial POSE&quot; can be specified to allow this routine to calculate absolute position.  If not specified the position is relative to the position at reset.  More than one instance of this can be used if needed.  One instance could track absolute field position while another instance can track relative position for executing a trajectory.</P>
<P></P>
<P>Parameters:</P>
<P>  - Left distance -- Left wheel encoder distance (meters)</P>
<P>  - Right distance -- Right wheel encodeer distance (meters)</P>
<P>  - Heading - Robot gyroscope reading</P>
<P>   - Reset - When set, this resets the remembered left, right distance and gyroscope values, and sets the current pose to the initial pose.  </P>
<P>    - Reset Pose - (Optional) When reset is TRUE this pose is used to set the current robot pose.  (If the inital pose is zero or not present, the result will be a relative pose.  If the reset pose is the absolute field pose, then the result current pose will be absolute.)</P>
<P></P>
<P>Results:</P>
<P>  - currentRelativePose - The new pose of the robot.  (If the initial pose is absolute, this will be an absolute pose.)</P>
<P><IMG SRC="Trajectory__Library_lvlib_DiffOdometry__Updatec.png" ALT="Trajectory_Library.lvlib:DiffOdometry_Update.vi"></P>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="cdbl.png" ALT="cdbl"></P>
</TD>
<TD>
<B>LeftDistance</B> </TD>
</TR>
</Table>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="cdbl.png" ALT="cdbl"></P>
</TD>
<TD>
<B>RightDistance</B> </TD>
</TR>
</Table>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="cbool.png" ALT="cbool"></P>
</TD>
<TD>
<B>Reset</B> </TD>
</TR>
</Table>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="cnclst.png" ALT="cnclst"></P>
</TD>
<TD>
<B>Heading</B> <P>Rotation2d data cluster typedef.  A rotation in a 2d coordinate frame represented a point on the unit circle (cosine and sine).</P>
<P></P>
<P>Default values are set for 0 degrees (0 radians).</P>
</TD>
</TR>
</Table>
<UL>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="cdbl.png" ALT="cdbl"></P>
</TD>
<TD>
<B>VALUE</B> <P>The rotation angle (Radians)</P>
</TD>
</TR>
</Table>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="cdbl.png" ALT="cdbl"></P>
</TD>
<TD>
<B>COS</B> <P>The cosine of the rotation angle</P>
</TD>
</TR>
</Table>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="cdbl.png" ALT="cdbl"></P>
</TD>
<TD>
<B>SIN</B> <P>The sine of the rotation angle.</P>
</TD>
</TR>
</Table>
</UL>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="ccclst.png" ALT="ccclst"></P>
</TD>
<TD>
<B>Reset Pose</B> <P>Pose2d data cluster typedef.  Represents a 2d pose containing translational and rotational elements.</P>
</TD>
</TR>
</Table>
<UL>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="cnclst.png" ALT="cnclst"></P>
</TD>
<TD>
<B>TRANSLATION</B> <P>Translation2D data cluster typedef.  Represents a translation in 2d space.  This can be used to represent a point or a vector.</P>
<P></P>
<P>This assumes that you are using conventional mathematical axes.  When the robot is placed on the origin, facing toward the X direction, moving forward increases the X, whereas moving to the left increases the Y.</P>
</TD>
</TR>
</Table>
<UL>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="cdbl.png" ALT="cdbl"></P>
</TD>
<TD>
<B>X</B> <P> The X component of the translation </P>
</TD>
</TR>
</Table>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="cdbl.png" ALT="cdbl"></P>
</TD>
<TD>
<B>Y</B> <P> The Y component of the translation</P>
</TD>
</TR>
</Table>
</UL>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="cnclst.png" ALT="cnclst"></P>
</TD>
<TD>
<B>ROTATION</B> <P>Rotation2d data cluster typedef.  A rotation in a 2d coordinate frame represented a point on the unit circle (cosine and sine).</P>
<P></P>
<P>Default values are set for 0 degrees (0 radians).</P>
</TD>
</TR>
</Table>
<UL>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="cdbl.png" ALT="cdbl"></P>
</TD>
<TD>
<B>VALUE</B> <P>The rotation angle (Radians)</P>
</TD>
</TR>
</Table>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="cdbl.png" ALT="cdbl"></P>
</TD>
<TD>
<B>COS</B> <P>The cosine of the rotation angle</P>
</TD>
</TR>
</Table>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="cdbl.png" ALT="cdbl"></P>
</TD>
<TD>
<B>SIN</B> <P>The sine of the rotation angle.</P>
</TD>
</TR>
</Table>
</UL>
</UL>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="icclst.png" ALT="icclst"></P>
</TD>
<TD>
<B>CurrentRelativePose</B> <P>Pose2d data cluster typedef.  Represents a 2d pose containing translational and rotational elements.</P>
</TD>
</TR>
</Table>
<UL>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="inclst.png" ALT="inclst"></P>
</TD>
<TD>
<B>TRANSLATION</B> <P>Translation2D data cluster typedef.  Represents a translation in 2d space.  This can be used to represent a point or a vector.</P>
<P></P>
<P>This assumes that you are using conventional mathematical axes.  When the robot is placed on the origin, facing toward the X direction, moving forward increases the X, whereas moving to the left increases the Y.</P>
</TD>
</TR>
</Table>
<UL>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="idbl.png" ALT="idbl"></P>
</TD>
<TD>
<B>X</B> <P> The X component of the translation </P>
</TD>
</TR>
</Table>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="idbl.png" ALT="idbl"></P>
</TD>
<TD>
<B>Y</B> <P> The Y component of the translation</P>
</TD>
</TR>
</Table>
</UL>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="inclst.png" ALT="inclst"></P>
</TD>
<TD>
<B>ROTATION</B> <P>Rotation2d data cluster typedef.  A rotation in a 2d coordinate frame represented a point on the unit circle (cosine and sine).</P>
<P></P>
<P>Default values are set for 0 degrees (0 radians).</P>
</TD>
</TR>
</Table>
<UL>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="idbl.png" ALT="idbl"></P>
</TD>
<TD>
<B>VALUE</B> <P>The rotation angle (Radians)</P>
</TD>
</TR>
</Table>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="idbl.png" ALT="idbl"></P>
</TD>
<TD>
<B>COS</B> <P>The cosine of the rotation angle</P>
</TD>
</TR>
</Table>
<Table>
<TR valign=TOP>
<TD>
<P><IMG SRC="idbl.png" ALT="idbl"></P>
</TD>
<TD>
<B>SIN</B> <P>The sine of the rotation angle.</P>
</TD>
</TR>
</Table>
</UL>
</UL>
</BODY>
</HTML>
